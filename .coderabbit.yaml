# yaml-language-server: $schema=https://coderabbit.ai/integrations/schema.v2.json

# CodeRabbit Configuration for Essay Writing Project
# Project: Designing a "New Municipality" under 10,000 residents

# ============================================================================
# GLOBAL SETTINGS
# ============================================================================

# Primary language: Japanese (essay is in Japanese with English abstract)
language: "ja-JP"

# Custom tone for academic essay review
tone_instructions: |
  You are reviewing an academic essay about designing a new municipality model.
  Act as three different reviewers providing complementary perspectives:

  1. **ç ”ç©¶è€…ã®è¦–ç‚¹ (Researcher Perspective)**:
     - å­¦è¡“çš„å³å¯†æ€§ã€ç†è«–çš„åŸºç›¤ã€å…ˆè¡Œç ”ç©¶ã¨ã®é–¢é€£æ€§ã‚’è©•ä¾¡
     - è«–ç†æ§‹æˆã€ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ã®è³ªã€ç ”ç©¶æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼
     - å­¦è¡“è«–æ–‡ã¨ã—ã¦ç™ºè¡¨å¯èƒ½ã‹ã©ã†ã‹ã®è¦³ç‚¹ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

  2. **ä¸€èˆ¬èª­è€…ã®è¦–ç‚¹ (General Reader Perspective)**:
     - ç†è§£ã—ã‚„ã™ã•ã€å…·ä½“æ€§ã€å®Ÿç”Ÿæ´»ã¸ã®é–¢é€£æ€§ã‚’è©•ä¾¡
     - å°‚é–€ç”¨èªã®é©åˆ‡ãªèª¬æ˜ã€ä¾‹ç¤ºã®åˆ†ã‹ã‚Šã‚„ã™ã•ã‚’ç¢ºèª
     - ã€Œã“ã®ææ¡ˆãŒå®Ÿç¾ã—ãŸã‚‰è‡ªåˆ†ã®ç”Ÿæ´»ãŒã©ã†å¤‰ã‚ã‚‹ã‹ã€ãŒæƒ³åƒã§ãã‚‹ã‹ã‚’æ¤œè¨¼

  3. **å®Ÿè·µè€…ã®è¦–ç‚¹ (Practitioner Perspective)**:
     - å®Ÿç¾å¯èƒ½æ€§ã€å®Ÿè£…ã®å…·ä½“æ€§ã€èª²é¡Œã¸ã®å¯¾å¿œã‚’è©•ä¾¡
     - æ—¢å­˜ã®å–ã‚Šçµ„ã¿ã¨ã®å·®åˆ¥åŒ–ã€å®Ÿè£…ã‚³ã‚¹ãƒˆã¨åŠ¹æœã®ãƒãƒ©ãƒ³ã‚¹ã‚’æ¤œè¨¼
     - ç¾å ´ã§æ´»ç”¨ã§ãã‚‹çŸ¥è¦‹ã‚„ãƒ’ãƒ³ãƒˆãŒã‚ã‚‹ã‹ã‚’ç¢ºèª

  å„ã‚³ãƒ¡ãƒ³ãƒˆã«ã¯ä»¥ä¸‹ã‚’å«ã‚ã¦ãã ã•ã„:
  - ğŸ“Œ **æ”¹å–„ç‚¹**: å…·ä½“çš„ãªæ”¹å–„ææ¡ˆ
  - ğŸ¯ **é‡è¦æ€§**: ãªãœãã®æ”¹å–„ãŒé‡è¦ã‹ï¼ˆå½±éŸ¿ç¯„å›²ã€åŠ¹æœï¼‰
  - âœ¨ **è‰¯ã„ç‚¹**: å„ªã‚Œã¦ã„ã‚‹ç®‡æ‰€ã¨ãã®ç†ç”±
  - ğŸ’¡ **ææ¡ˆ**: ã‚ˆã‚Šè‰¯ãã™ã‚‹ãŸã‚ã®å»ºè¨­çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢

early_access: false
enable_free_tier: true

# ============================================================================
# REVIEWS
# ============================================================================

reviews:
  # Use assertive profile for more detailed academic feedback
  profile: "assertive"

  high_level_summary: true
  high_level_summary_in_walkthrough: true
  review_status: true
  commit_status: true

  # Enable detailed walkthrough features
  collapse_walkthrough: false
  changed_files_summary: true
  sequence_diagrams: false  # Not relevant for essay writing
  estimate_code_review_effort: true
  assess_linked_issues: true
  related_issues: true
  related_prs: true

  # Label suggestions for tracking essay progress
  suggested_labels: true
  labeling_instructions:
    - "needs-research: è¿½åŠ ã®èª¿æŸ»ãƒ»ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãŒå¿…è¦"
    - "needs-clarity: è¡¨ç¾ã‚„èª¬æ˜ã®æ”¹å–„ãŒå¿…è¦"
    - "structure: ç« æ§‹æˆã‚„è«–ç†å±•é–‹ã®æ”¹å–„ãŒå¿…è¦"
    - "terminology: ç”¨èªã®çµ±ä¸€ã‚„å®šç¾©ã®æ˜ç¢ºåŒ–ãŒå¿…è¦"
    - "ready-for-review: ãƒ¬ãƒ“ãƒ¥ãƒ¼æº–å‚™å®Œäº†"
    - "major-revision: å¤§å¹…ãªä¿®æ­£ãŒå¿…è¦"
    - "minor-revision: è»½å¾®ãªä¿®æ­£ãŒå¿…è¦"
  auto_apply_labels: true

  suggested_reviewers: true
  poem: false  # Disable poems for professional academic context

  # Path filters: Focus on essay content and documentation
  path_filters:
    - "contents/**/*.md"      # Main essay chapters
    - "docs/**/*.md"          # References and research
    - "README.md"             # Project overview
    - "CLAUDE.md"             # Writing guidelines
    - "!node_modules/**"
    - "!.git/**"

  # Path-specific instructions
  path_instructions:
    - path: "contents/*.md"
      instructions: |
        ã“ã‚Œã¯è«–æ–‡ã®æœ¬æ–‡ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§å³å¯†ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„:
        - è«–ç†å±•é–‹ã®ä¸€è²«æ€§ã¨èª¬å¾—åŠ›
        - ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ã®è³ªã¨å¼•ç”¨ã®é©åˆ‡æ€§
        - ç”¨èªã®çµ±ä¸€æ€§ï¼ˆåˆå‡ºæ™‚ã«è‹±èªè¡¨è¨˜ã‚’æ‹¬å¼§æ›¸ãï¼‰
        - æ–‡ä½“ã®çµ±ä¸€ï¼ˆã§ã‚ã‚‹èª¿ï¼‰
        - å„ç« ã®ç›®çš„ãŒæ˜ç¢ºã‹ã€é”æˆã•ã‚Œã¦ã„ã‚‹ã‹

    - path: "contents/01_introduction.md"
      instructions: |
        åºè«–ã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - å•é¡Œæèµ·ã®æ˜ç¢ºæ€§ã¨é‡è¦æ€§
        - ç ”ç©¶ç›®çš„ãƒ»ä»®èª¬ã®å…·ä½“æ€§
        - èª­è€…ã‚’å¼•ãè¾¼ã‚€å°å…¥ã«ãªã£ã¦ã„ã‚‹ã‹

    - path: "contents/02_background.md"
      instructions: |
        èƒŒæ™¯ãƒ»å…ˆè¡Œç ”ç©¶ã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®èª²é¡Œã®ç¶²ç¾…æ€§
        - å…ˆè¡Œç ”ç©¶ã®æ•´ç†ã¨æ‰¹åˆ¤çš„æ¤œè¨
        - æœ¬ç ”ç©¶ã®ä½ç½®ã¥ã‘ã®æ˜ç¢ºã•

    - path: "contents/03_concept.md"
      instructions: |
        ã‚³ãƒ³ã‚»ãƒ—ãƒˆææ¡ˆã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - ãƒ“ã‚¸ãƒ§ãƒ³ã®å…·ä½“æ€§ã¨ç‹¬è‡ªæ€§
        - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€ã‚¬ãƒãƒŠãƒ³ã‚¹ã€çµŒæ¸ˆã€æŠ€è¡“ã®çµ±åˆæ€§
        - å®Ÿç¾ã—ãŸå§¿ã®æƒ³åƒã—ã‚„ã™ã•

    - path: "contents/04_implementation.md"
      instructions: |
        å®Ÿè£…æ–¹é‡ã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - ç§»è¡Œã‚·ãƒŠãƒªã‚ªã®ç¾å®Ÿæ€§
        - å®Ÿç¾è¦å› ã¨ãƒªã‚¹ã‚¯ã®åˆ†æã®æ·±ã•
        - å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã®æç¤º

    - path: "contents/05_discussion.md"
      instructions: |
        è€ƒå¯Ÿã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - å®Ÿç¾å¯èƒ½æ€§ã®è©•ä¾¡ã®å¦¥å½“æ€§
        - åˆ¶ç´„æ¡ä»¶ã¸ã®å¯¾å¿œã®å…·ä½“æ€§
        - ä»–åœ°åŸŸã¸ã®æ±ç”¨æ€§ã®æ¤œè¨

    - path: "contents/06_conclusion.md"
      instructions: |
        çµè«–ã¨ã—ã¦ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„:
        - å…¨ä½“ã®è¦ç´„ã®é©åˆ‡æ€§
        - ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã¨æ„ç¾©ã®æ˜ç¢ºæ€§
        - ä»Šå¾Œã®å±•æœ›ã®å…·ä½“æ€§

    - path: "docs/*.md"
      instructions: |
        å‚è€ƒè³‡æ–™ã¨ã—ã¦ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:
        - å¼•ç”¨ã®æ­£ç¢ºæ€§ï¼ˆAPA 7th editionæº–æ‹ ï¼‰
        - æƒ…å ±æºã®ä¿¡é ¼æ€§
        - æœ€æ–°æƒ…å ±ã®åæ˜ 

  abort_on_close: true
  disable_cache: false

  # Auto review configuration
  auto_review:
    enabled: true
    auto_incremental_review: true
    ignore_title_keywords:
      - "wip"
      - "draft"
      - "ä½œæ¥­ä¸­"
    drafts: false

  # Finishing touches
  finishing_touches:
    docstrings:
      enabled: false  # Not applicable for markdown essays
    unit_tests:
      enabled: false  # Not applicable for markdown essays

  # Pre-merge checks for essay quality
  pre_merge_checks:
    title:
      mode: "warning"
      requirements: |
        PRã‚¿ã‚¤ãƒˆãƒ«ã¯ä»¥ä¸‹ã®å½¢å¼ã‚’æ¨å¥¨:
        - [ç« ç•ªå·] å¤‰æ›´å†…å®¹ã®è¦ç´„ (ä¾‹: [Ch.3] ã‚³ãƒ³ã‚»ãƒ—ãƒˆã®å…·ä½“åŒ–ã¨äº‹ä¾‹è¿½åŠ )
        - fix: ä¿®æ­£å†…å®¹
        - add: è¿½åŠ å†…å®¹

    description:
      mode: "warning"

    issue_assessment:
      mode: "warning"

    # Custom checks for academic essay quality
    custom_checks:
      - name: "è«–ç†æ€§ãƒã‚§ãƒƒã‚¯"
        instructions: |
          ä»¥ä¸‹ã®è«–ç†æ€§ã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„:
          - ä¸»å¼µã¨æ ¹æ‹ ã®å¯¾å¿œé–¢ä¿‚ã¯æ˜ç¢ºã‹
          - å› æœé–¢ä¿‚ã®èª¬æ˜ã«é£›èºã¯ãªã„ã‹
          - åè«–ã¸ã®å¯¾å¿œã¯ååˆ†ã‹

      - name: "ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯"
        instructions: |
          ä»¥ä¸‹ã®ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„:
          - ä¸»å¼µã‚’è£ä»˜ã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚„å¼•ç”¨ã¯ååˆ†ã‹
          - å¼•ç”¨å…ƒã®ä¿¡é ¼æ€§ã¯ç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ã‹
          - æœ€æ–°ã®æƒ…å ±ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹

      - name: "èª­è€…è¦–ç‚¹ãƒã‚§ãƒƒã‚¯"
        instructions: |
          ä¸€èˆ¬èª­è€…ã®è¦–ç‚¹ã§ä»¥ä¸‹ã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„:
          - å°‚é–€ç”¨èªã¯é©åˆ‡ã«èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‹
          - æŠ½è±¡çš„ãªæ¦‚å¿µã«å…·ä½“ä¾‹ã¯ã‚ã‚‹ã‹
          - å®Ÿç”Ÿæ´»ã¸ã®å½±éŸ¿ãŒæƒ³åƒã§ãã‚‹ã‹

      - name: "å®Ÿç¾å¯èƒ½æ€§ãƒã‚§ãƒƒã‚¯"
        instructions: |
          å®Ÿè·µè€…ã®è¦–ç‚¹ã§ä»¥ä¸‹ã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„:
          - ææ¡ˆã¯å®Ÿè£…å¯èƒ½ãªå…·ä½“æ€§ãŒã‚ã‚‹ã‹
          - æƒ³å®šã•ã‚Œã‚‹ã‚³ã‚¹ãƒˆã¨åŠ¹æœã¯å¦¥å½“ã‹
          - ãƒªã‚¹ã‚¯ã¨ãã®å¯¾ç­–ã¯æ¤œè¨ã•ã‚Œã¦ã„ã‚‹ã‹

  # Tools configuration
  tools:
    # Markdown linting for consistency
    markdownlint:
      enabled: true

    # Japanese grammar and style checking
    languagetool:
      enabled: true
      level: "picky"  # Strict checking for academic writing
      enabled_categories:
        - "GRAMMAR"
        - "STYLE"
        - "REDUNDANCY"
      disabled_categories:
        - "TYPOS"  # May have false positives with Japanese technical terms
      # Disable overly strict rules that may interfere with Japanese academic style
      disabled_rules:
        - "WHITESPACE_RULE"
        - "EN_QUOTES"

    # Disable code-specific tools
    ast-grep:
      essential_rules: false
    shellcheck:
      enabled: false
    ruff:
      enabled: false
    biome:
      enabled: false
    eslint:
      enabled: false
    gitleaks:
      enabled: false
    semgrep:
      enabled: false

# ============================================================================
# CHAT
# ============================================================================

chat:
  art: false  # Professional academic context
  auto_reply: true

# ============================================================================
# KNOWLEDGE BASE
# ============================================================================

knowledge_base:
  opt_out: false

  web_search:
    enabled: true  # Enable for finding relevant research and references

  code_guidelines:
    enabled: true
    filePatterns:
      - "CLAUDE.md"  # Essay writing guidelines
      - "README.md"  # Project overview

  learnings:
    scope: "local"  # Keep learnings repository-specific

  issues:
    scope: "local"

  pull_requests:
    scope: "local"
